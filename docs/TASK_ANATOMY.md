# üéØ THE ANATOMY OF TASKS - The Bridge Between Vision and Execution

**Built**: 2025-10-12
**Status**: ‚úÖ OPERATIONAL - Task Structure Formalized
**Purpose**: Define the atomic structure that connects vision to code
**Vision**: USER MESSAGE ‚Üí SPEC ‚Üí TASK ‚Üí CODE ‚Üí PURPOSE FULFILLED

---

## üåü THE GRAND VISION: FROM TRUTH TO EXECUTION

**Lech's Complete Flow:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1. USER MESSAGES (Vision)                                    ‚îÇ
‚îÇ     ‚Üí Stored as TRUTH                                         ‚îÇ
‚îÇ     ‚Üí Guiding, future-driving, purpose-giving                 ‚îÇ
‚îÇ     ‚Üí Highly prizable ATOMS                                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2. VISION EXTRACTION                                         ‚îÇ
‚îÇ     ‚Üí Extract vision from user messages                       ‚îÇ
‚îÇ     ‚Üí Structure the purpose and goals                         ‚îÇ
‚îÇ     ‚Üí Define success criteria                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3. SPECFILES (Order & Structure)                            ‚îÇ
‚îÇ     ‚Üí Built into structured specifications                    ‚îÇ
‚îÇ     ‚Üí Ordered requirements                                    ‚îÇ
‚îÇ     ‚Üí Clear boundaries and scope                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4. TASKS (Atomic Execution Units) ‚Üê THIS LAYER             ‚îÇ
‚îÇ     ‚Üí Break specs into granular steps                        ‚îÇ
‚îÇ     ‚Üí Each step knows its "bigger vision"                     ‚îÇ
‚îÇ     ‚Üí Minimal context + Maximum clarity                       ‚îÇ
‚îÇ     ‚Üí Team-orchestrated execution                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  5. CODEBASE GENERATION                                       ‚îÇ
‚îÇ     ‚Üí System builds itself from tasks                         ‚îÇ
‚îÇ     ‚Üí Orchestrated agent teams                                ‚îÇ
‚îÇ     ‚Üí Complete file generation                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  6. APPLICATION CREATION                                      ‚îÇ
‚îÇ     ‚Üí Deployable product                                      ‚îÇ
‚îÇ     ‚Üí Complete features                                       ‚îÇ
‚îÇ     ‚Üí Production-ready                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  7. VALIDATION AGAINST SPECFILES                             ‚îÇ
‚îÇ     ‚Üí Test against success criteria                           ‚îÇ
‚îÇ     ‚Üí Verify purpose fulfillment                              ‚îÇ
‚îÇ     ‚Üí Quality assurance                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  8. PURPOSE FULFILLED                                         ‚îÇ
‚îÇ     ‚Üí Vision realized                                         ‚îÇ
‚îÇ     ‚Üí User value delivered                                    ‚îÇ
‚îÇ     ‚Üí Truth validated                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üß¨ WHAT IS A TASK?

**A TASK is the ATOMIC EXECUTION UNIT that bridges abstract vision and concrete code.**

**The Critical Bridge:**
- **Above**: Abstract specs (WHAT to build and WHY)
- **Below**: Concrete code (HOW it's built)
- **The Task**: Granular step with context connection

**Why Tasks Are Critical:**
1. **Minimal Context**: Agent doesn't need to understand entire system
2. **Clear Action**: Knows exactly what to do
3. **Vision Connection**: Understands "bigger picture" purpose
4. **Verifiable**: Clear success criteria
5. **Orchestratable**: Can be assigned, tracked, validated

---

## üìã THE 7 CRITICAL QUESTIONS EVERY TASK ANSWERS

**Every well-formed task must answer:**

### 1. WHAT: What Exactly Needs to Be Done?
```
task_name:        "Create Minerals Dashboard Component"
task_description: "Build a React component that displays mineral collection
                   with filtering, sorting, and search capabilities"
task_scope:       "Component only - API integration is separate task"
```

### 2. WHY: How Does This Connect to the Bigger Vision?
```
vision_context:   "Part of Minerals App - allows users to view their collection"
business_value:   "Users can discover, filter, and explore their minerals easily"
success_impact:   "Unlocks ability to add minerals to collection (next task)"
```

### 3. WHO: Which Agent/Role is Best Suited?
```
required_role:      "UI Specialist (Agent A)"
required_skills:    ["React", "TypeScript", "Tailwind CSS", "Component Design"]
required_knowledge: ["Dashboard patterns", "Table/Grid components", "Filtering"]
```

### 4. WHEN: What Dependencies Must Be Satisfied First?
```
depends_on_tasks: ["T-MINERALS-005 (API endpoint)",
                   "T-MINERALS-003 (Data types)"]
blocks_tasks:     ["T-MINERALS-012 (Add mineral flow)",
                   "T-MINERALS-015 (Export feature)"]
execution_order:  7
```

### 5. WHERE: What Files/Locations Are Involved?
```
target_files:       ["src/components/MineralsDashboard.tsx",
                     "src/components/MineralCard.tsx",
                     "src/lib/mineralUtils.ts"]
target_directories: ["src/components", "src/lib"]
working_directory:  "/minerals-app/src"
```

### 6. HOW: What Are the Step-by-Step Instructions?
```
step_by_step_instructions:
  "Step 1: Create MineralsDashboard.tsx component
   Step 2: Implement grid layout with responsive breakpoints
   Step 3: Add filtering controls (category, hardness, color)
   Step 4: Implement search functionality
   Step 5: Add sorting options (name, date added, rarity)
   Step 6: Create MineralCard sub-component
   Step 7: Integrate with minerals API
   Step 8: Add loading and error states
   Step 9: Write unit tests
   Step 10: Test accessibility (ARIA labels, keyboard nav)"

code_snippets_needed: ["react-grid-layout-snippet",
                       "filter-controls-snippet"]
prompts_needed:       ["component-structure-prompt"]
```

### 7. DONE: How Do We Know It's Complete?
```
acceptance_criteria:
  [
    "Dashboard renders without errors",
    "Grid layout is responsive (mobile/tablet/desktop)",
    "All filters work correctly",
    "Search returns accurate results",
    "Sorting updates display properly",
    "Loading states display during data fetch",
    "Error states handle API failures gracefully",
    "Unit tests cover > 80% of code",
    "Accessibility score > 95%",
    "No console errors or warnings"
  ]

validation_method: "Automated tests + Manual review"
test_commands:     ["npm test", "npm run test:accessibility"]
expected_outputs:  "All tests pass, component renders correctly"
definition_of_done: "Build passes, tests pass, code reviewed, deployed to staging"
```

---

## üóÑÔ∏è TASK ANATOMY: DATABASE SCHEMA

### Core Task Structure (tasks_registry table)

```sql
CREATE TABLE tasks_registry (
    task_id TEXT PRIMARY KEY,              -- "T-MINERALS-007"
    task_name TEXT NOT NULL,               -- "Create Minerals Dashboard"

    -- VISION CONNECTION (WHY)
    spec_id TEXT NOT NULL,                 -- Parent specification
    vision_context TEXT NOT NULL,          -- Bigger picture connection
    business_value TEXT NOT NULL,          -- Why this matters
    success_impact TEXT,                   -- What success unlocks

    -- WHAT (Task Definition)
    task_type TEXT NOT NULL,               -- feature, bug_fix, refactor, test, doc
    task_category TEXT NOT NULL,           -- frontend, backend, database, infrastructure
    task_description TEXT NOT NULL,        -- Detailed description
    task_scope TEXT NOT NULL,              -- Boundaries
    minimal_context TEXT NOT NULL,         -- Minimum info to execute

    -- WHO (Agent Assignment)
    required_role TEXT NOT NULL,           -- Agent role needed
    required_skills TEXT,                  -- JSON: skills needed
    required_knowledge TEXT,               -- JSON: knowledge domains
    assigned_agent TEXT,                   -- Currently assigned

    -- WHEN (Dependencies & Timing)
    depends_on_tasks TEXT,                 -- JSON: task dependencies
    blocks_tasks TEXT,                     -- JSON: tasks this blocks
    execution_order INTEGER DEFAULT 0,     -- Order within spec
    can_parallelize BOOLEAN DEFAULT FALSE, -- Can run in parallel?

    -- WHERE (Location & Scope)
    target_files TEXT,                     -- JSON: files to modify/create
    target_directories TEXT,               -- JSON: directories
    working_directory TEXT,                -- Where to work

    -- HOW (Execution Instructions)
    step_by_step_instructions TEXT NOT NULL, -- Detailed steps
    code_snippets_needed TEXT,             -- JSON: snippet IDs
    prompts_needed TEXT,                   -- JSON: prompt IDs
    context_files_needed TEXT,             -- JSON: context IDs

    -- DONE (Success Criteria)
    acceptance_criteria TEXT NOT NULL,     -- JSON: must-have conditions
    validation_method TEXT NOT NULL,       -- How to verify
    test_commands TEXT,                    -- Commands for validation
    expected_outputs TEXT,                 -- What success looks like
    definition_of_done TEXT NOT NULL,      -- Clear completion criteria

    -- STATUS & TRACKING
    status TEXT DEFAULT 'PENDING',         -- PENDING, READY, IN_PROGRESS, BLOCKED, COMPLETED
    priority TEXT DEFAULT 'MEDIUM',        -- LOW, MEDIUM, HIGH, CRITICAL
    complexity TEXT DEFAULT 'MEDIUM',      -- SIMPLE, MEDIUM, COMPLEX, EPIC
    estimated_hours REAL,
    actual_hours REAL,

    -- QUALITY METRICS
    code_quality_score REAL DEFAULT 0.0,   -- 0-1
    test_coverage REAL DEFAULT 0.0,        -- 0-1
    documentation_score REAL DEFAULT 0.0,  -- 0-1
    overall_quality_score REAL DEFAULT 0.0 -- 0-1 combined
);
```

### Supporting Tables

**task_execution_steps** - Break task into granular steps
**task_dependencies** - Explicit dependency tracking
**task_validation_rules** - Automated validation
**task_resources** - Files, docs, context needed
**task_agents** - Agent interaction history
**task_templates** - Reusable task patterns

---

## üìê IDEAL TASK FORMAT (Markdown Template)

```markdown
# Task: [Task Name]

**Task ID**: T-[PROJECT]-[NUMBER]
**Spec ID**: spec-[project]-[spec]
**Priority**: [LOW/MEDIUM/HIGH/CRITICAL]
**Complexity**: [SIMPLE/MEDIUM/COMPLEX/EPIC]
**Estimated Hours**: [X.X hours]

---

## üéØ VISION CONNECTION (Why This Matters)

**Bigger Vision:**
[How this task connects to the overall product vision]

**Business Value:**
[Why this matters to users/product/business]

**Success Impact:**
[What successful completion unlocks or enables]

---

## üìã WHAT (Task Definition)

**Description:**
[Detailed description of what needs to be done]

**Scope:**
- **Included**: [What's in scope]
- **Excluded**: [What's out of scope]

**Minimal Context:**
[Minimum information needed to execute this task]

---

## üë§ WHO (Agent Assignment)

**Required Role**: [UI Specialist / Backend / Database / Integration]

**Required Skills**:
- [Skill 1]
- [Skill 2]
- [Skill 3]

**Required Knowledge**:
- [Knowledge domain 1]
- [Knowledge domain 2]

---

## ‚è±Ô∏è WHEN (Dependencies)

**Depends On** (must complete first):
- [ ] T-[PROJECT]-[NUMBER]: [Task name]
- [ ] T-[PROJECT]-[NUMBER]: [Task name]

**Blocks** (can't start until this completes):
- T-[PROJECT]-[NUMBER]: [Task name]
- T-[PROJECT]-[NUMBER]: [Task name]

**Execution Order**: #[X] in spec sequence

**Can Parallelize**: [Yes/No]

---

## üìç WHERE (Location)

**Target Files**:
- [Path to file 1]
- [Path to file 2]

**Target Directories**:
- [Directory 1]
- [Directory 2]

**Working Directory**: [/path/to/work]

---

## üîß HOW (Step-by-Step Instructions)

### Step 1: [Step Name]
[Detailed instructions for step 1]

### Step 2: [Step Name]
[Detailed instructions for step 2]

### Step 3: [Step Name]
[Detailed instructions for step 3]

[... continue for all steps]

### Resources Needed:
- **Code Snippets**: [snippet-id-1, snippet-id-2]
- **Prompts**: [prompt-id-1, prompt-id-2]
- **Context Files**: [context-id-1, context-id-2]
- **External Docs**: [URL 1, URL 2]

### Example Code:
```[language]
[Example implementation or reference code]
```

---

## ‚úÖ DONE (Success Criteria)

### Acceptance Criteria:
- [ ] [Criterion 1]
- [ ] [Criterion 2]
- [ ] [Criterion 3]
- [ ] [Criterion 4]
- [ ] [Criterion 5]

### Validation Method:
[How to verify completion - automated tests, manual review, etc.]

### Test Commands:
```bash
[Command 1]
[Command 2]
[Command 3]
```

### Expected Outputs:
[What success looks like - test results, UI behavior, API responses]

### Definition of Done:
- [ ] Code written and tested
- [ ] Tests pass (>80% coverage)
- [ ] Code reviewed and approved
- [ ] Documentation updated
- [ ] Deployed to staging
- [ ] Acceptance criteria verified

### Quality Requirements:
- **Code Quality**: >0.8
- **Test Coverage**: >0.8
- **Documentation**: >0.9
- **Overall**: >0.8

---

## üì¶ DELIVERABLES

- [Deliverable 1]
- [Deliverable 2]
- [Deliverable 3]

---

## üìù NOTES

[Any additional notes, considerations, or context]
```

---

## üé® TASK TEMPLATES (Pre-Configured Patterns)

### Template 1: React Component Task
**Use When**: Creating a new React component
**Variables**: component_name, component_purpose, component_props, design_specs
**Estimated Hours**: 4 hours
**See**: task_templates table for complete template

### Template 2: API Endpoint Task
**Use When**: Creating a new API endpoint
**Variables**: endpoint_method, endpoint_path, request_format, response_format
**Estimated Hours**: 5 hours
**See**: task_templates table for complete template

### Template 3: Database Schema Task
**Use When**: Defining new database schema
**Variables**: entity_name, table_structure, relationships, constraints
**Estimated Hours**: 3 hours
**See**: task_templates table for complete template

---

## üîÑ TASK LIFECYCLE

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   PENDING   ‚îÇ ‚Üê Task created from spec
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    READY    ‚îÇ ‚Üê All dependencies satisfied
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ IN_PROGRESS ‚îÇ ‚Üê Agent working on task
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  COMPLETED  ‚îÇ ‚Üê Task finished, validated
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  VALIDATED  ‚îÇ ‚Üê Tests pass, criteria met
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Alternate paths:
- BLOCKED: Waiting on unmet dependency
- FAILED: Validation failed, needs rework
- CANCELLED: No longer needed
```

---

## üéØ MINIMAL CONTEXT PRINCIPLE

**The Core Principle:**
> "An agent should be able to complete a task with ONLY the task definition - no need to read entire spec or understand entire system."

**What This Means:**
- Task contains ALL information needed to execute
- Vision connection provides "why" without requiring full context
- Step-by-step instructions are self-contained
- All resources (snippets, prompts, context) are referenced
- Success criteria are clear and testable

**Example of Minimal Context:**
```
‚ùå BAD (requires external context):
"Update the dashboard to show minerals"

‚úÖ GOOD (self-contained):
"Create MineralsDashboard component at src/components/MineralsDashboard.tsx
 that fetches minerals from /api/minerals and displays them in a responsive
 grid with filtering by category, search by name, and sorting by date added.
 Use MineralCard sub-component for each mineral. See snippet-grid-layout
 for layout pattern and prompt-component-structure for component organization."
```

---

## üîó TASK-TO-SPEC TRACEABILITY

**Every task traces back to vision:**
```
User Message: "I want to track my mineral collection"
    ‚Üì
Spec: spec-minerals-app-v1
    ‚Üì
Tasks:
    T-MINERALS-001: Database schema for minerals
    T-MINERALS-002: API endpoints for CRUD operations
    T-MINERALS-003: Data types and interfaces
    T-MINERALS-004: Authentication system
    T-MINERALS-005: Minerals collection API
    T-MINERALS-006: Dashboard layout component
    T-MINERALS-007: Minerals dashboard component ‚Üê WE ARE HERE
    T-MINERALS-008: Add mineral form
    ...
```

**Each task knows:**
- Its parent spec (spec_id)
- Its vision context (how it fits in bigger picture)
- Its business value (why user cares)
- Its success impact (what it unlocks)

---

## üìä TASK QUALITY METRICS

**Quality Score Calculation:**
```
overall_quality_score = (
    code_quality_score * 0.4 +
    test_coverage * 0.3 +
    documentation_score * 0.3
)
```

**Quality Thresholds:**
- **0.9-1.0**: Excellent - Gold standard
- **0.8-0.9**: Good - Production ready
- **0.7-0.8**: Acceptable - Minor improvements needed
- **0.0-0.7**: Poor - Significant work required

**Quality Requirements (Per Task):**
- Code Quality: >0.8
- Test Coverage: >0.8
- Documentation: >0.9
- Overall: >0.8

---

## üöÄ TASK ORCHESTRATION

**Agent Team Coordination:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  SPEC: Minerals App                                       ‚îÇ
‚îÇ  Total Tasks: 25                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  TASK ASSIGNMENT (by required_role)                      ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  Agent A (UI):        T-007, T-008, T-010, T-012         ‚îÇ
‚îÇ  Agent C (Backend):   T-001, T-002, T-005, T-009         ‚îÇ
‚îÇ  Agent D (Database):  T-003, T-004                       ‚îÇ
‚îÇ  Agent B (Review):    T-013, T-020, T-025                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PARALLEL EXECUTION (can_parallelize = TRUE)             ‚îÇ
‚îÇ                                                           ‚îÇ
‚îÇ  Group 1: T-001, T-003, T-004 (no dependencies)          ‚îÇ
‚îÇ  Group 2: T-002, T-005 (depends on Group 1)              ‚îÇ
‚îÇ  Group 3: T-007, T-008 (depends on Group 2)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  VALIDATION & INTEGRATION                                ‚îÇ
‚îÇ  ‚Üí Each task validates individually                       ‚îÇ
‚îÇ  ‚Üí Integration tests verify task interactions             ‚îÇ
‚îÇ  ‚Üí Spec success criteria verified                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üéØ THE POWER OF GRANULAR STEPS

**Example: Breaking Down "Create Dashboard"**

**‚ùå Too Coarse (not granular enough):**
```
Task: Create dashboard
Steps: 1. Build UI, 2. Add features, 3. Test
```
**Problem**: Agent doesn't know exactly what to do at each step.

**‚úÖ Properly Granular:**
```
Task: Create Minerals Dashboard Component
Steps:
  1. Create MineralsDashboard.tsx in src/components/
  2. Implement responsive grid layout (mobile: 1 col, tablet: 2 col, desktop: 3 col)
  3. Add filter controls for category (dropdown) and hardness (range slider)
  4. Implement search input with debounced API calls (300ms delay)
  5. Add sorting dropdown (name ASC/DESC, date added, rarity)
  6. Create MineralCard sub-component with image, name, category, hardness
  7. Integrate with /api/minerals endpoint using React Query
  8. Add loading skeleton UI during data fetch
  9. Add error boundary for API failures
  10. Write unit tests for filtering, sorting, search logic
  11. Test accessibility with screen reader
  12. Verify responsive layout on mobile/tablet/desktop
```
**Why This Works**: Each step is atomic, actionable, and verifiable.

---

## üîÆ FROM VISION TO EXECUTION: COMPLETE EXAMPLE

### User Message (Vision - The Truth)
```
"I want a minerals app where I can catalog my collection,
filter by properties like hardness and color, search by name,
and see beautiful cards with images. It should work on my phone."
```

### Vision Extraction
```
Purpose: Enable mineral collectors to organize and explore their collection
Key Features: Catalog, filtering, search, mobile-friendly
Success: Users can easily manage and discover their minerals
```

### Spec Creation (spec-minerals-app-v1)
```
Requirements:
  - REQ-001: Database schema for minerals
  - REQ-002: API for CRUD operations
  - REQ-003: Mobile-responsive dashboard
  - REQ-004: Filtering by hardness, color, category
  - REQ-005: Search by name
  - REQ-006: Card-based UI with images

Success Criteria:
  - User can add mineral to collection
  - User can filter by any property
  - User can search by name
  - UI works on mobile (< 768px width)
```

### Task Breakdown (T-MINERALS-007)
```
Task Name: Create Minerals Dashboard Component
Spec ID: spec-minerals-app-v1
Requirement: REQ-003, REQ-004, REQ-005, REQ-006

Vision Context:
  "This dashboard is the primary interface where users explore
   their mineral collection - it's where the app's purpose
   (helping collectors organize and discover) is realized."

Business Value:
  "Users spend 80% of their time here - this is THE core feature."

Minimal Context:
  "Component displays minerals in responsive grid, allows filtering
   by hardness/color/category, search by name, and displays mineral
   cards with images."

Step-by-Step Instructions:
  [12 detailed steps as shown above]

Acceptance Criteria:
  - Grid is responsive (1/2/3 columns)
  - Filters update display in real-time
  - Search works with 300ms debounce
  - Cards show all mineral info
  - Loading states display correctly
  - Mobile works perfectly (< 768px)
  - Tests cover >80% of code
  - Accessibility score >95%

Definition of Done:
  - Code complete, tested, reviewed, deployed to staging
  - All acceptance criteria verified
  - No console errors
  - Quality score >0.8
```

### Code Generation
```typescript
// Generated from task T-MINERALS-007
// Using template: react-component-task
// With snippets: react-grid-layout, filter-controls

export default function MineralsDashboard() {
  // Implementation following step-by-step instructions...
}
```

### Validation Against Spec
```
‚úÖ REQ-003: Dashboard is mobile-responsive
‚úÖ REQ-004: Filtering by hardness, color, category works
‚úÖ REQ-005: Search by name functional
‚úÖ REQ-006: Card-based UI with images displays correctly

SUCCESS CRITERIA MET: 100%
QUALITY SCORE: 0.91
PURPOSE FULFILLED: ‚úÖ
```

---

## üéâ THE COMPLETE FLOW REALIZED

```
USER MESSAGE (Vision/Truth)
    ‚Üì [Vision Extraction]
SPECFILE (Ordered Structure)
    ‚Üì [Task Breakdown]
TASKS (Granular Steps with Vision Context)
    ‚Üì [Agent Orchestration]
CODE GENERATION (Using Templates & Snippets)
    ‚Üì [Build & Integrate]
APPLICATION (Complete & Functional)
    ‚Üì [Validation]
TESTING AGAINST SPEC (Success Criteria)
    ‚Üì [Verification]
PURPOSE FULFILLED (Vision Realized)
```

**The Magic:**
- User provides vision in natural language
- System structures it into specs
- Specs break down into granular tasks
- Tasks contain ALL context needed to execute
- Agents work independently with minimal coordination
- Code generates following predetermined workflows
- Validation proves purpose fulfillment

**From 5 sentences ‚Üí Full commercial application**

---

## üìö RELATED DOCUMENTATION

- **Specifications Registry**: `SPECIFICATIONS_REGISTRY.md`
- **Specbase-to-Codebase Pipeline**: `SPECBASE_TO_CODEBASE_PIPELINE.md`
- **Code Snippets Library**: `CODE_SNIPPETS_LIBRARY.md`
- **Prompts Library**: `PROMPTS_LIBRARY.md`
- **Context Files System**: `CONTEXT_FILES_SYSTEM.md`

---

## üéØ CONCLUSION

**THE ANATOMY OF TASKS is the CRITICAL BRIDGE between vision and execution.**

**What We Built:**
- ‚úÖ Complete task schema (7 tables)
- ‚úÖ The 7 critical questions framework
- ‚úÖ Minimal context principle
- ‚úÖ Task-to-vision traceability
- ‚úÖ Quality metrics system
- ‚úÖ Pre-configured templates
- ‚úÖ Complete documentation

**Impact:**
- üéØ **Clear Execution**: Agents know exactly what to do
- üîó **Vision Connection**: Every task knows its "bigger picture"
- üìä **Quality Assurance**: Automated validation and scoring
- ü§ñ **Agent Orchestration**: Team coordination through dependencies
- ‚úÖ **Purpose Fulfillment**: Traceable from truth to execution

**The Power:**
> "A task is not just work to be done - it's a bridge between abstract vision and concrete code, carrying the user's truth into reality."

---

**Built by**: Agent B (Sonnet-4.5)
**Date**: 2025-10-12
**Status**: ‚úÖ OPERATIONAL

**THE BRIDGE IS BUILT! VISION ‚Üí EXECUTION COMPLETE!** üéØüöÄ
